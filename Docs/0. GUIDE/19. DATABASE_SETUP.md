# 데이터베이스 설정 가이드

## 1. SQLite 설치 확인
### Windows
1. PowerShell에서 확인:
```powershell
sqlite3 --version
```

2. 설치되어 있지 않다면 설치:
```powershell
# 1. SQLite 다운로드 (https://www.sqlite.org/download.html)
# 2. 압축 해제 후 C:\sqlite 폴더 생성
# 3. 환경 변수 PATH에 C:\sqlite 추가
```

### Linux/Mac
```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install sqlite3

# Mac
brew install sqlite3
```

## 2. 데이터베이스 생성
1. 프로젝트의 data 디렉토리로 이동:
```powershell
# Windows
cd project_root\data

# Linux/Mac
cd project_root/data
```

2. SQLite 데이터베이스 생성 및 스키마 적용:
```powershell
# Windows
sqlite3 trading_bot.db ".read schema.sql"

# Linux/Mac
sqlite3 trading_bot.db < schema.sql
```

## 3. 데이터베이스 확인
SQLite 콘솔에서 테이블 확인:
```sql
# 데이터베이스 접속
sqlite3 trading_bot.db

# 테이블 목록 확인
.tables

# 특정 테이블 스키마 확인
.schema ohlcv
.schema trades
.schema arbitrage_opportunities
.schema onchain_transactions

# 데이터베이스 종료
.quit
```

## 4. 권한 설정
### Windows
```powershell
# 현재 사용자에게 읽기/쓰기 권한 부여
icacls trading_bot.db /grant:r "%USERNAME%":(F)
```

### Linux/Mac
```bash
# 읽기/쓰기 권한 설정
chmod 644 trading_bot.db
```

## 5. 데이터베이스 백업
```powershell
# Windows
sqlite3 trading_bot.db ".backup 'backup_trading_bot.db'"

# Linux/Mac
sqlite3 trading_bot.db ".backup 'backup_trading_bot.db'"
```

## 6. 유용한 SQLite 명령어
```sql
-- 테이블의 첫 5개 레코드 조회
SELECT * FROM ohlcv LIMIT 5;

-- 특정 테이블의 레코드 수 확인
SELECT COUNT(*) FROM trades;

-- 데이터베이스 상태 확인
PRAGMA integrity_check;

-- 데이터베이스 최적화
VACUUM;
```

## 7. 문제 해결
1. 권한 오류
   - 데이터베이스 파일의 소유권과 권한을 확인
   - 필요한 경우 상위 디렉토리의 권한도 확인

2. 데이터베이스 잠금 오류
   - 다른 프로세스가 DB를 사용 중인지 확인
   - 필요한 경우 프로세스 종료 후 재시도

3. 디스크 공간 부족
   - 정기적으로 불필요한 데이터 정리
   - VACUUM 명령으로 디스크 공간 최적화 